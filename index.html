<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CraftCanvaS</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com https://cdn.jsdelivr.net https://scaleflex.cloudimg.io https://fonts.googleapis.com blob: data:; font-src 'self' https://fonts.gstatic.com;">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/fabric@5.3.0/dist/fabric.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://scaleflex.cloudimg.io/v7/plugins/filerobot-image-editor/4.6.0/filerobot-image-editor.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="logo">
                <span style="color:#fff; text-shadow: 2px 2px 0 #000;">CRAFT</span><span style="color:var(--accent); text-shadow: 2px 2px 0 #000;">CANVAS</span>
            </div>
            <nav>
                <button id="nav-play" class="nav-btn active" onclick="window.switchTab('play')">
                    <img src="assets/tab_ui images/grass1.png" class="nav-icon" alt="Play"> Play
                </button>
                
                <button id="nav-instances" class="nav-btn" onclick="window.switchTab('instances')">
                    <img src="assets/icons/cube.png" class="nav-icon" onerror="this.src='assets/tab_ui images/grass1.png'" alt="Instances"> Instances
                </button>
                
                <div class="nav-sep"></div>
                
                <button id="nav-browse" class="nav-btn" onclick="window.switchTab('browse')">
                    <img id="browse-icon-img" src="assets/tab_ui images/eye.png" class="nav-icon floating-icon" alt="Browse"> Browse
                </button> 
                
                <div class="nav-sep"></div>
                
                <button id="nav-studio" class="nav-btn special-btn" onclick="window.switchTab('studio')">
                    <img src="assets/tab_ui images/studio.png" class="nav-icon" alt="Studio"> Studio
                </button>
                
                <div class="nav-sep"></div>

                <button id="nav-about" class="nav-btn" onclick="window.switchTab('about')">
                    <span style="font-size: 1.5rem;">‚ÑπÔ∏è</span> About
                </button>
                
                <div style="flex-grow:1"></div>
                
                <button id="nav-settings" class="nav-btn" onclick="window.switchTab('settings')">
                    ‚öôÔ∏è Settings
                </button>
            </nav>
            <div class="user-profile">
                <div id="login-section">
                    <button id="btn-google-login" class="login-btn-google">Sign in with Google</button>
                </div>
                <div id="profile-section" class="hidden">
                    <div class="profile-card">
                        <img id="user-avatar" src="assets/icons/steve.png" class="profile-pic">
                        <div class="profile-info">
                            <span id="user-name" class="profile-name">User</span>
                        </div>
                    </div>
                    <button id="btn-logout" class="text-btn">Sign Out</button>
                </div>
            </div>
        </aside>

        <main class="content" id="main-content">
            
            <div id="tab-play" class="tab-section">
                <div class="hero-launch">
                    <h1 class="hero-title">MINECRAFT</h1>
                    <div class="launch-controls">
                        <select id="play-select-instance" class="filter-select large"><option>Select Instance...</option></select>
                        <button id="btn-launch" class="mega-button large">PLAY</button>
                    </div>
                    <p id="launch-status" class="status-text"></p>
                </div>
            </div>

            <div id="tab-instances" class="tab-section hidden">
                <div class="filter-bar">
                    <h2 class="mc-text">Instances</h2>
                    <button onclick="document.getElementById('modal-new-inst').classList.remove('hidden')" class="action-btn-secondary">+ Create</button>
                </div>
                <div id="grid-instances" class="instance-grid"></div>
            </div>

            <div id="tab-browse" class="tab-section hidden browser-layout-container">
                <div class="browse-header">
                    <div class="browse-categories">
                        <button class="browse-cat-btn active" onclick="window.switchBrowseType('mod')">Mods</button>
                        <button class="browse-cat-btn" onclick="window.switchBrowseType('resourcepack')">Resource Packs</button>
                        <button class="browse-cat-btn" onclick="window.switchBrowseType('shader')">Shaders</button>
                    </div>
                    <div class="browse-search-bar">
                        <input id="browse-search" class="modrinth-search" placeholder="Search...">
                        <button id="btn-browse-search" class="modrinth-btn">Search</button>
                    </div>
                </div>

                <div class="browse-body">
                    <div class="browse-filters">
                        <h3 class="mc-text">Filters</h3>
                        <label class="mc-label">Version</label>
                        <select id="browse-filter-ver" class="modrinth-select full"><option value="any">Any</option></select>
                        <label class="mc-label">Loader</label>
                        <select id="browse-filter-loader" class="modrinth-select full"><option value="any">Any</option></select>
                    </div>

                    <div id="browse-grid" class="modrinth-grid"></div>
                </div>
            </div>

            <div id="tab-studio" class="tab-section hidden studio-layout">
                <div class="studio-top-bar">
                    <button onclick="window.addImageToEditor()" title="Open Image">üìÇ Open Img</button>
                    <div class="sep"></div>
                    <button onclick="window.openProjectFile()" title="Open Project">üìÇ Open Proj</button>
                    <button onclick="window.saveProjectFile()" title="Save Project">üíæ Save Proj</button>
                    <div class="sep"></div>
                    <span style="font-size: 0.8rem; color: #aaa; margin-left: 10px; font-family: 'Segoe UI', sans-serif;">
                        ‚ÑπÔ∏è Click "Save" inside the editor to Export PNG/JPG
                    </span>
                </div>

                <div class="studio-workspace">
                    <div id="studio-workspace-container"></div>
                </div>
            </div> 

            <div id="tab-settings" class="tab-section hidden">
                <div class="settings-container">
                    <h2 class="mc-text">Settings</h2>
                    <div class="slider-group">
                        <label class="mc-label">Max RAM: <span id="lbl-ram">4 GB</span></label>
                        <input type="range" id="sett-ram" min="2" max="16" step="1" class="mc-slider">
                    </div>
                    <br>
                    <button id="btn-save-settings" class="modrinth-btn">Save Changes</button>
                </div>
            </div>
            
            <div id="tab-about" class="tab-section hidden">
                <div class="settings-container about-container">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h1 class="mc-text" style="font-size: 3rem; color: var(--accent);">CRAFTCANVAS</h1>
                        <h3 style="color: #fff;">Version 1.1.0</h3>
                    </div>

                    <div class="about-section">
                        <h2 class="mc-text">Creator</h2>
                        <p style="font-size: 1.5rem; color: #55FF55;">Eadullah Rahman Abid</p>
                        <p style="color: #aaa;">&copy; 2025 Eadullah Rahman Abid. All rights reserved.</p>
                    </div>

                    <div class="about-section">
                        <h2 class="mc-text">Features</h2>
                        <ul class="feature-list">
                            <li>üßä <strong>Instance Manager:</strong> Create, manage, and delete Minecraft instances easily.</li>
                            <li>üîç <strong>Mod Browser:</strong> Search and download Mods, Resource Packs, and Shaders via Modrinth.</li>
                            <li>üñåÔ∏è <strong>Studio:</strong> Built-in Image Editor for creating thumbnails and textures.</li>
                            <li>‚òÅÔ∏è <strong>Cloud Sync:</strong> Google Login integration.</li>
                            <li>üöÄ <strong>Launcher:</strong> Integrated Microsoft Auth & Minecraft Launcher Core.</li>
                        </ul>
                    </div>

                    <div class="about-section">
                        <h2 class="mc-text">Credits & Licenses</h2>
                        <div class="credits-box">
                            <pre id="credits-text">Loading credits...</pre>
                        </div>
                    </div>
                </div>
            </div>

            <div id="detail-view" class="detail-overlay hidden">
                <div class="detail-container">
                    <button id="btn-close-detail" class="back-btn">‚Üê Back</button>
                    <div class="detail-header-card">
                        <img id="detail-icon" src="">
                        <div class="detail-meta">
                            <h1 id="detail-title"></h1>
                            <p id="detail-desc-short"></p>
                        </div>
                        <button id="btn-install-main" class="modrinth-btn large">Install</button>
                    </div>
                    <div id="markdown-body" class="markdown-body"></div>
                </div>
            </div>

        </main>
    </div>

    <div id="modal-new-inst" class="hidden modal-overlay">
        <div class="modal-box">
            <h3 class="mc-text">New Instance</h3>
            <input id="new-inst-name" class="modrinth-search full" type="text" placeholder="Instance Name" autocomplete="off">
            <select id="new-inst-ver" class="modrinth-select full"></select>
            <select id="new-inst-loader" class="modrinth-select full"></select>
            <div class="modal-actions">
                <button onclick="document.getElementById('modal-new-inst').classList.add('hidden')" class="action-btn-secondary">Cancel</button>
                <button id="btn-create-inst" class="modrinth-btn">Create</button>
            </div>
        </div>
    </div>

    <div id="modal-download-selection" class="hidden modal-overlay">
        <div class="modal-box">
            <h3 class="mc-text">Select Version</h3>
            <select id="dl-version-select" class="modrinth-select full"></select>
            <select id="dl-loader-select" class="modrinth-select full"></select>
            <button id="btn-confirm-download" class="modrinth-btn full">Download</button>
            <button onclick="document.getElementById('modal-download-selection').classList.add('hidden')" class="action-btn-secondary full" style="margin-top:5px">Cancel</button>
        </div>
    </div>

    <script src="logic_settings.js"></script>
    <script src="studio.js"></script> 
    <script src="logic_nav.js"></script>
    <script src="logic_mods.js"></script>
    <script src="logic_instances.js"></script>
    <script src="logic_auth.js"></script>
    
    <script>
        fetch('CREDITS.txt')
            .then(res => res.text())
            .then(text => document.getElementById('credits-text').innerText = text)
            .catch(() => document.getElementById('credits-text').innerText = "Could not load CREDITS.txt");
    </script>
</body>
</html>